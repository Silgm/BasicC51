C51 COMPILER V9.59.0.0   GPIO                                                              01/07/2019 18:37:52 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE GPIO
OBJECT MODULE PLACED IN .\Objects\gpio.obj
COMPILER INVOKED BY: D:\Program Files (x86)\Keil_v5\C51\BIN\C51.EXE gpio.c LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE DEBUG PRI
                    -NT(.\Listings\gpio.lst) OBJECT(.\Objects\gpio.obj)

line level    source

   1          #include "gpio.h"
   2          #include <reg52.h>
   3          
   4          #define PIN_TO_MASK(p)  (0x01<<(p%8))
   5          #define PIN_TO_PORT(p)  (p>>3)
   6          
   7          void digitalWrite(Pin pin, uint8_t val)
   8          {
   9   1              uint8_t bitMask = PIN_TO_MASK(pin);
  10   1              Port port = PIN_TO_PORT(pin);
  11   1              
  12   1              if (port == PORT_0)
  13   1              {
  14   2                      if(val)
  15   2                              P0 |= bitMask;
  16   2                      else
  17   2                              P0 &= ~(bitMask);
  18   2              }
  19   1              else if (port == PORT_1)
  20   1              {
  21   2                      if(val)
  22   2                              P1 |= bitMask;
  23   2                      else
  24   2                              P1 &= ~(bitMask);
  25   2              }
  26   1              else 
  27   1              {
  28   2                      if(val)
  29   2                              P2 |= bitMask;
  30   2                      else
  31   2                              P2 &= ~(bitMask);
  32   2              }
  33   1      }
  34          
  35          
  36          uint8_t digitalRead(Pin pin)
  37          {
  38   1              uint8_t bitMask = PIN_TO_MASK(pin);
  39   1              Port port = PIN_TO_PORT(pin);
  40   1              
  41   1              if (port == PORT_0)
  42   1              {
  43   2                      if(P0 & bitMask)
  44   2                              return HIGH;
  45   2                      else
  46   2                              return LOW;
  47   2              }
  48   1              else if (port == PORT_1)
  49   1              {
  50   2                      if(P1 & bitMask)
  51   2                              return HIGH;
  52   2                      else
  53   2                              return LOW;
  54   2              }
C51 COMPILER V9.59.0.0   GPIO                                                              01/07/2019 18:37:52 PAGE 2   

  55   1              else 
  56   1              {
  57   2                      if(P2 & bitMask)
  58   2                              return HIGH;
  59   2                      else
  60   2                              return LOW;
  61   2              }
  62   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    127    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
